<!DOCTYPE html>
<html lang="en">

<head>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/cal-heatmap/dist/cal-heatmap.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/cal-heatmap/dist/cal-heatmap.css">
  <script src="https://unpkg.com/cal-heatmap/dist/plugins/Legend.min.js"></script>
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/cal-heatmap/dist/plugins/Tooltip.min.js"></script>
  <sript src="./js/main.js"></sript>
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Document</title>
</head>

<body>
  <h1 class="text-3xl font-bold underline text-center">
	Daily Progress
  </h1>
  <div id="cal-heatmap" class="flex justify-center items-center my-4 text-lg"></div>
  <div id="legend-label" class="flex justify-center items-center"></div>
  <script>
	 const cal = new CalHeatmap();
	 cal.paint(
	   {
		 data: {
		source: '/pomos',
		 type: "json",
		 x: "date",
		 y: "pomos",
		 groupY: "sum"
		 },
		 date: { start: new Date('2023-01-01') },
		 range: 1,
		 scale: { color: { type: 'linear', scheme: 'PRGn', domain: [0, 40] } },
		 domain: {
		   type: 'year',
		   label: { text: null },
		 },
		 subDomain: { type: 'day', radius: 2 },
		 itemSelector: '#ex-year',
	   },
	   [
		 [
		   Tooltip,
		   {
			 text: function (date, value, dayjsDate) {
			   return (
				 (value ? value + '°C' : 'No data') + ' on ' + dayjsDate.format('LL')
			   );
			 },
		   },
		 ],
		 [
		   Legend,
		   {
			 tickSize: 0,
			 width: 150,
			 itemSelector: '#ex-year-legend',
			 label: 'Seattle max temperature °C',
		   },
		 ],
		 [
		   CalendarLabel,
		   {
			 width: 30,
			 textAlign: 'start',
			 text: () => dayjs.weekdaysShort().map((d, i) => (i % 2 == 0 ? '' : d)),
		   },
		 ],
	   ]
	 );
	 
	 render(
	   <div>
		 <div id="ex-year" className="margin-bottom--md"></div>
		 <a
		   className="button button--sm button--secondary margin-top--sm"
		   href="#"
		   onClick={e => {
			 e.preventDefault();
			 cal.previous();
		   }}
		 >
		   ← Previous
		 </a>
		 <a
		   className="button button--sm button--secondary margin-top--sm margin-left--xs"
		   href="#"
		   onClick={e => {
			 e.preventDefault();
			 cal.next();
		   }}
		 >
		   Next →
		 </a>
		 <div id="ex-year-legend" style={{ float: 'right' }}></div>
	   </div>
	 );
  </script>
</body>

</html>